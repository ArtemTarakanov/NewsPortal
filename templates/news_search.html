{% extends 'flatpages/default.html' %}
{% load news_filters %}
{% load news_tags %}

{% block title %}
–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π
{% endblock title %}

{% block content %}
    <h1>–ü–æ–∏—Å–∫ –Ω–æ–≤–æ—Å—Ç–µ–π</h1>
    
    <div class="mb-4">
        <a href="{% url 'news_list' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫–æ –≤—Å–µ–º –Ω–æ–≤–æ—Å—Ç—è–º</a>
    </div>
    
    {# –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ —Å –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º #}
    <form action="" method="get" class="mb-4">
        <div class="row">
            <div class="col-md-4">
                <label for="id_title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:</label>
                {{ filterset.form.title }}
            </div>
            <div class="col-md-4">
                <label for="id_author__user__username" class="form-label">–ò–º—è –∞–≤—Ç–æ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç:</label>
                {{ filterset.form.author__user__username }}
            </div>
            <div class="col-md-4">
                <label for="id_date_creation__gt" class="form-label">–ü–æ–∑–∂–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∞—Ç—ã:</label>
                {{ filterset.form.date_creation__gt }}
            </div>
        </div>
        <div class="mt-3">
            <input type="submit" value="–ù–∞–π—Ç–∏" class="btn btn-primary" />
            <a href="{% url 'news_search' %}" class="btn btn-outline-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </div>
    </form>
    
    <hr>

    {% if news %}  
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ ({{ news|length }}):</h3>
        
        {% for item in news %}  
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">{{ item.title|censor }}</h5>  
                    <p class="text-muted">
                        {{ item.date_creation|date:'d.m.Y' }} | 
                        –ê–≤—Ç–æ—Ä: {{ item.author.user.username }} | 
                        –¢–∏–ø: {% if item.category_type == 'NW' %}–ù–æ–≤–æ—Å—Ç—å{% else %}–°—Ç–∞—Ç—å—è{% endif %}
                    </p>
                    <p class="card-text">{{ item.text|censor|truncatechars:100 }}</p>
                    <div class="mt-2">
                        <a href="{% url 'news_edit' item.pk %}" class="btn btn-warning btn-sm">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="{% url 'news_delete' item.pk %}" class="btn btn-danger btn-sm">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                </div>
            </div>
        {% endfor %}
        
        {# –ü–∞–≥–∏–Ω–∞—Ü–∏—è #}
        {% if is_paginated %}
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    {% if page_obj.has_previous %}
                        <li class="page-item">
                            <a class="page-link" href="?{% url_replace page=1 %}">–ü–µ—Ä–≤–∞—è</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?{% url_replace page=page_obj.previous_page_number %}">‚Üê –ù–∞–∑–∞–¥</a>
                        </li>
                    {% endif %}

                    <li class="page-item disabled">
                        <span class="page-link">
                            –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
                        </span>
                    </li>

                    {% if page_obj.has_next %}
                        <li class="page-item">
                            <a class="page-link" href="?{% url_replace page=page_obj.next_page_number %}">–í–ø–µ—Ä–µ–¥ ‚Üí</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link" href="?{% url_replace page=page_obj.paginator.num_pages %}">–ü–æ—Å–ª–µ–¥–Ω—è—è</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>
        {% endif %}
        
    {% else %}  
        <div class="alert alert-info">
            <h4>–ù–æ–≤–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h4>
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø–æ–∏—Å–∫–∞.</p>
        </div>
    {% endif %}
{% endblock content %}