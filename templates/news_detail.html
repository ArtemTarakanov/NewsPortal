{% extends 'flatpages/default.html' %}
{% load news_filters %}
{% block title %}
{{ news.title }}
{% endblock title %}

{% block content %}
<div class="card">
    <div class="card-body">
        <h1>{{ news.title|censor }}</h1>
        <p class="text-muted">
            {{ news.date_creation|date:'d.m.Y' }} | 
            Автор: {{ news.author.user.username }} | 
            Рейтинг: {{ news.rating }}
        </p>
        <hr>
        
        <p>{{ news.text|censor }}</p>
        
        {# ↓↓↓ КНОПКИ ПОДПИСКИ НА КАТЕГОРИИ ↓↓↓ #}
        {% if user.is_authenticated %}
            <div class="mb-3">
                <h6>Подписаться на категории:</h6>
                {% for category in news.categories.all %}
                    {% if user in category.subscribers.all %}
                        <a href="{% url 'unsubscribe' category.id %}" class="btn btn-outline-secondary btn-sm">Отписаться от {{ category.name }}</a>
                    {% else %}
                        <a href="{% url 'subscribe' category.id %}" class="btn btn-primary btn-sm">Подписаться на {{ category.name }}</a>
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}

        <div class="mt-3">
            <a href="/news/" class="btn btn-primary">← Назад к списку новостей</a>
        </div>
    </div>
</div>
{% endblock content %}